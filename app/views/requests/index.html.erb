<h1 class="display-3 text-primary">Request</h1>

<h3><%= @msg %></h3>


<%#= form_with @user, url: {controller: 'users', action: 'index' } do  |form| %>
<%= form_with(model: @cabinet, url: cabinets_path,local: true) do |f| %>
<%#= form_with(model: @request, local: true) do |f| %> <%# form_with はデフォルトでcabinets_pathを認識、cabinet controllerのnew createに飛ぶことが決定 %>

  <table class="table table-striped table-bordered text-center "> <%# table class="table" 基本のテーブルが作成される＋α %>

    <tr class="table-primary ">
      <th>　</th><th>No.</th><th>File No.</th><th>File Name</th><th>保管期限</th><th>保管場所</th><th>起案者</th><th>起案日</th><th>コメント</th>
    </tr>

    <% @requests.each do |obj| %> <%# 一括データ取り出し %>
    <tr>
      <td>
        <div class="form-group">
          <%= f.check_box :cabinet_id, id: "check1" %>
        </div>
      </td>
      
      <td><%= obj.id %></td>
      <td class="text-left"><%= obj.file_no %></td>
      <td class="text-left"><%= obj.file_name %></td>
      <td><%= obj.expired_at %></td>
      <td><%= obj.placed_at %></td>
      <td><%= obj.user_id %></td>
      <td><%= obj.created_at.to_s(:datetime_jp) %></td> <%# to_sとは配列を文字列に変換するメソッドで、配列の各要素を文字列に変換して連結した文字列を返します。%>
      <td><%= obj.comment %></td>
    </tr>
  
    <% end %>
  </table>

  <%#= form_with @cabinet, url: {controller: 'cabinets', action: 'create' } do  |form| %>
    <%#= form.text_field :name %>
    <%#= f.submit '承認', class: 'btn btn-primary ' %>
  <%# end %>


  <%= f.submit '承認', class: 'btn btn-primary ' %>  <%# f.submit⇒対応するモデルクラスが何も情報を持っていなければ自動的にcreateアクションへ、すでに情報を持っている場合はupdateアクションへ自動的に振り分けてくれる %>
<% end %>

<%= link_to '差し戻し', @request, method: :delete, data: { confirm: '本当に差し戻してよろしいですか？' }, class: 'btn btn-danger' %>

<%= paginate @requests %> <%# ページネイトができるようになる %>
